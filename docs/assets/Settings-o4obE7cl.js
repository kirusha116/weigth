import{j as a}from"./index-BeCuPwBW.js";import{u as N,a as C,B as i}from"./storageHooks-CwwqM7_V.js";import{u as S,t as D,r as g,g as w,h as I}from"./App-D2-Ha4M8.js";import{u as V}from"./index.esm-Dbxk_ohI.js";import{I as o}from"./input-BTxUv2af.js";import{g as H,s as K}from"./index-9ccb475d-CaR4NyNH.js";const r={name:"name",startWeigth:"startWeigth",targetWeigth:"targetWeigth",maxCallories:"maxCallories"},M={[r.name]:"Имя",[r.startWeigth]:"Начальный вес",[r.targetWeigth]:"Цель",[r.maxCallories]:"Допустимое количество каллорий в день"};function G(){const{name:u,startWeigth:h,targetWeigth:x,maxCallories:p,startWeigthDate:b}=N(),f=C(),m=S(),{register:n,handleSubmit:d,reset:W,setValue:c}=V({defaultValues:{name:u,startWeigth:h?.toString(),targetWeigth:x?.toString(),maxCallories:p?.toString()}}),j=e=>{const t={};e.name&&(t.name=e.name),e.startWeigth&&(t.startWeigth=Number(e.startWeigth)),e.targetWeigth&&(t.targetWeigth=Number(e.targetWeigth)),e.maxCallories&&(t.maxCallories=Number(e.maxCallories)),!b&&t.startWeigth&&(t.startWeigthDate=w(),t.currentWeigthDate=t.startWeigthDate,t.currentWeigth=t.startWeigth),f(I(t))};return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-2xl mb-6",children:a.jsx("b",{children:"Настройки"})}),a.jsxs("form",{onSubmit:d(j),children:[Object.values(r).map(e=>a.jsxs("div",{children:[a.jsx("label",{className:"text-md",children:M[e]}),e==="name"?a.jsx(o,{className:"bg-white mt-2 mb-4",...n(e),enterKeyHint:"done"}):e==="maxCallories"?a.jsx(o,{className:"bg-white mt-2 mb-4",...n(e),type:"text",inputMode:"numeric",pattern:"[0-9]*",enterKeyHint:"done",onPaste:t=>t.preventDefault(),onInput:t=>{const s=t.target.value.replace(/[^0-9]/g,"");c(e,s,{shouldValidate:!0})}}):a.jsx(o,{className:"bg-white mt-2 mb-4",...n(e),type:"text",inputMode:"numeric",pattern:"[0-9]*",enterKeyHint:"done",onPaste:t=>t.preventDefault(),onInput:t=>{let s=t.target.value.replace(/[^0-9.,]/g,"");s=s.replace(",",".");const l=s.split(".");l.length>2&&(s=l[0]+"."+l.slice(1).join("")),Number(s)%1&&(s=(Math.floor(Number(s)*10)/10).toString()),c(e,s,{shouldValidate:!0})}})]},e)),a.jsxs("div",{className:"flex mt-4 justify-end",children:[a.jsx(i,{variant:"outline",className:"ml-auto mr-4",type:"submit",onClick:()=>D.success("Сохранено",{classNames:{toast:"flex justify-center !w-fit relative left-[50%] translate-x-[-50%] ",title:"text-base ml-2 text-nowrap"}}),children:"Сохранить"}),a.jsx(i,{variant:"rose",onClick:()=>{W()},children:"Cбросить"})]})]}),a.jsx(i,{className:"block mt-4 ml-auto mr-0 bg-black text-white",onClick:()=>{const e=H();K(e).then(()=>{g(),m("/"),location.reload()}).catch(t=>{console.log(t.code)})},children:"Выйти из профиля"}),a.jsx(i,{className:"block mt-4 ml-auto mr-0 bg-black text-white",onClick:()=>{g(),m("/"),location.reload()},children:"Очистить память"})]})}export{G as default};
